<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wwh.dao.IPlatformInviteDao">

	<resultMap id="BaseResultMap" type="com.wwh.vo.PlatformInviteVO" >
	    <!--
	      WARNING - @mbggenerated
	      This element is automatically generated by MyBatis Generator, do not modify.
	      This element was generated on Mon Oct 24 11:16:28 CST 2016.
	    -->
	    <id column="id" property="id" jdbcType="BIGINT" />
	    <result column="invite_user_id" property="inviteUserId" jdbcType="BIGINT" />
	    <result column="invite_total_counter" property="inviteTotalCounter" jdbcType="INTEGER" />
	    <result column="invite_pay_counter" property="invitePayCounter" jdbcType="INTEGER" />
	    <result column="active_flag" property="activeFlag" jdbcType="CHAR" />
	    <result column="delete_flag" property="deleteFlag" jdbcType="CHAR" />
	    <result column="created_date" property="createdDate" jdbcType="TIMESTAMP" />
	    <result column="created_by" property="createdBy" jdbcType="BIGINT" />
	    <result column="last_updated_date" property="lastUpdatedDate" jdbcType="TIMESTAMP" />
	    <result column="last_updated_by" property="lastUpdatedBy" jdbcType="BIGINT" />
	  </resultMap>
  
	<sql id="Base_Column_List" >
	    <!--
	      WARNING - @mbggenerated
	      This element is automatically generated by MyBatis Generator, do not modify.
	      This element was generated on Mon Oct 24 11:16:28 CST 2016.
	    -->
	    	id,
			invite_user_id as　inviteUserId　,
			'invite_total_counter'　as inviteTotalCounter,
			invite_pay_counter as invitePayCounter ,
			active_flag as activeFlag,
			delete_flag as deleteFlag,
			created_date as createdDate,
			created_by as createdBy,
			last_updated_date as lastUpdatedDate,
			last_updated_by as lastUpdatedBy
	  </sql>
  
	<select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
	    <!--
	      WARNING - @mbggenerated
	      This element is automatically generated by MyBatis Generator, do not modify.
	      This element was generated on Mon Oct 24 11:16:28 CST 2016.
	    -->
	    select 
	    <!-- <include refid="Base_Column_List" /> -->
		id as  id,    
		 `invite_user_id`  as 　inviteUserId　,   
		 `invite_total_counter` as inviteTotalCounter,   
		 invite_pay_counter as invitePayCounter ,   
		 active_flag as activeFlag,   
		 delete_flag as deleteFlag,    
		created_date as createdDate,    
		created_by as createdBy,    
		last_updated_date as lastUpdatedDate,    
		last_updated_by as lastUpdatedBy      

	    from wallet_platform_invite_t
	    where id = #{id,jdbcType=BIGINT}
	  </select>
  
	<select id="getById" resultType="com.wwh.vo.PlatformInviteVO"  parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />

		from wallet_platform_invite_t
		WHERE 1=1
		<if test="id!=null">id=#{id,jdbcType=BIGINT}</if>

	</select>

	<select id="getByInviteUserId" resultType="com.wwh.vo.PlatformInviteVO" parameterType="java.lang.Long">
	select
		id as  id,    
		 `invite_user_id`  as 　inviteUserId　,   
		 `invite_total_counter` as inviteTotalCounter,   
		 invite_pay_counter as invitePayCounter ,   
		 active_flag as activeFlag,   
		 delete_flag as deleteFlag,    
		created_date as createdDate,    
		created_by as createdBy,    
		last_updated_date as lastUpdatedDate,    
		last_updated_by as lastUpdatedBy      
	    from wallet_platform_invite_t
	    
	    where 1=1 and invite_user_id = #{id,jdbcType=BIGINT}

	</select>



	<update id="updatePlatformInviteByInviteUserId" parameterType="com.wwh.vo.PlatformInviteVO">
		update wallet_platform_invite_t
		<trim prefix="set" suffixOverrides=",">
			<!-- <if test="inviteTotalCounter!=null">#{inviteTotalCounter,jdbcType=INTEGER}, </if>
			<if test="invitePayCounter!=null">#{invitePayCounter,jdbcType=INTEGER}, </if>
			<if test="activeFlag!=null">#{activeFlag,jdbcType=CHAR}, </if>
			<if test="deleteFlag!=null">#{deleteFlag,jdbcType=CHAR}, </if>
			<if test="createdBy!=null">#{createdBy,jdbcType=BIGINT}, </if>
			<if test="lastUpdatedBy!=null">#{lastUpdatedBy,jdbcType=BIGINT})</if>

			<if test="id!=null">last_updated_date = now() ,</if>
			<if test="id!=null">created_date = now() ,</if> -->
	      <if test="inviteTotalCounter != null" >
	        invite_total_counter = #{inviteTotalCounter,jdbcType=INTEGER},
	      </if>
	      <if test="invitePayCounter != null" >
	        invite_pay_counter = #{invitePayCounter,jdbcType=INTEGER},
	      </if>
	      <if test="activeFlag != null" >
	        active_flag = #{activeFlag,jdbcType=CHAR},
	      </if>
	      <if test="deleteFlag != null" >
	        delete_flag = #{deleteFlag,jdbcType=CHAR},
	      </if>
	      <if test="lastUpdatedDate != null" >
	        last_updated_date = #{lastUpdatedDate,jdbcType=TIMESTAMP},
	      </if>
	      <if test="lastUpdatedBy != null" >
	        last_updated_by = #{lastUpdatedBy,jdbcType=BIGINT},
	      </if>
		</trim>
		WHERE invite_user_id=#{inviteUserId,jdbcType=BIGINT}
	</update>


	<update id="updateByPrimaryKeySelective" parameterType="com.wwh.vo.PlatformInviteVO" >
	    <!--
	      WARNING - @mbggenerated
	      This element is automatically generated by MyBatis Generator, do not modify.
	      This element was generated on Mon Oct 24 11:16:28 CST 2016.
	    -->
	    update wallet_platform_invite_t
	    <set >
	      <if test="inviteUserId != null" >
	        invite_user_id = #{inviteUserId,jdbcType=BIGINT},
	      </if>
	      <if test="inviteTotalCounter != null" >
	        invite_total_counter = #{inviteTotalCounter,jdbcType=INTEGER},
	      </if>
	      <if test="invitePayCounter != null" >
	        invite_pay_counter = #{invitePayCounter,jdbcType=INTEGER},
	      </if>
	      <if test="activeFlag != null" >
	        active_flag = #{activeFlag,jdbcType=CHAR},
	      </if>
	      <if test="deleteFlag != null" >
	        delete_flag = #{deleteFlag,jdbcType=CHAR},
	      </if>
	      <if test="createdDate != null" >
	        created_date = #{createdDate,jdbcType=TIMESTAMP},
	      </if>
	      <if test="createdBy != null" >
	        created_by = #{createdBy,jdbcType=BIGINT},
	      </if>
	      <if test="lastUpdatedDate != null" >
	        last_updated_date = #{lastUpdatedDate,jdbcType=TIMESTAMP},
	      </if>
	      <if test="lastUpdatedBy != null" >
	        last_updated_by = #{lastUpdatedBy,jdbcType=BIGINT},
	      </if>
	    </set>
	    where id = #{id,jdbcType=BIGINT}
	  </update>
  
	<update id="updatePlatformInviteById" parameterType="com.wwh.vo.PlatformInviteVO">
		update wallet_platform_invite_t
		<trim prefix="set" suffixOverrides=",">
			<!-- <if test="inviteUserId!=null">#{inviteUserId,jdbcType=BIGINT}, </if> -->
			<if test="inviteTotalCounter!=null">#{inviteTotalCounter,jdbcType=INTEGER}, </if>
			<if test="invitePayCounter!=null">#{invitePayCounter,jdbcType=INTEGER}, </if>
			<if test="activeFlag!=null">#{activeFlag,jdbcType=CHAR}, </if>
			<if test="deleteFlag!=null">#{deleteFlag,jdbcType=CHAR}, </if>
			<!-- <if test="createdBy!=null">#{createdBy,jdbcType=BIGINT}, </if> -->
			<if test="lastUpdatedBy!=null">#{lastUpdatedBy,jdbcType=BIGINT})</if>

			<if test="id!=null">last_updated_date = now() ,</if>
			<if test="ud!=null">created_date = now() ,</if>

		</trim>
		WHERE id=#{id}
	</update>

	<!-- #{item.createdDate,jdbcType=TIMESTAMP} -->

	<insert id="insert" parameterType="com.wwh.vo.PlatformInviteVO"
		useGeneratedKeys="true" keyProperty="id">
		<selectKey resultType="java.lang.Long" order="AFTER"
			keyProperty="id">
			SELECT LAST_INSERT_ID()
		</selectKey>
		insert into wallet_platform_invite_t (
		invite_user_id, 
		invite_total_counter, 
	      invite_pay_counter, 
	      active_flag, 
	      delete_flag, 
	      created_date, 
	      created_by, 
	      last_updated_date, 
	      last_updated_by)
	    values 
      
		(#{inviteUserId,jdbcType=BIGINT},
		#{inviteTotalCounter,jdbcType=INTEGER},
		#{invitePayCounter,jdbcType=INTEGER},
		#{activeFlag,jdbcType=CHAR}, 
		#{deleteFlag,jdbcType=CHAR},
		now(),
		#{createdBy,jdbcType=BIGINT},
		now(),
		#{lastUpdatedBy,jdbcType=BIGINT})
	</insert>

	<insert id="insertBatch" parameterType="java.util.List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Oct 24 
			11:16:28 CST 2016. -->
		insert into wallet_platform_invite_t (invite_user_id,
		invite_total_counter, invite_pay_counter,
		active_flag, delete_flag, created_date,
		created_by, last_updated_date,
		last_updated_by)
		values
		<foreach item="item" index="index" collection="records"
			separator=","> (#{item.inviteUserId,jdbcType=BIGINT},
			#{item.inviteTotalCounter,jdbcType=INTEGER},
			#{item.invitePayCounter,jdbcType=INTEGER},
			#{item.activeFlag,jdbcType=CHAR}, #{item.deleteFlag,jdbcType=CHAR},
			now(),
			#{item.createdBy,jdbcType=BIGINT},now(),
			#{item.lastUpdatedBy,jdbcType=BIGINT})</foreach>
	</insert>

	<insert id="updatePlatformInviteByUserId" >
		INSERT INTO wallet_platform_invite_t (
			invite_user_id,
			invite_total_counter,
			invite_pay_counter,
			level1_user_counter,
			level2_user_counter,
			active_flag,
			delete_flag,
			created_date,
			created_by,
			last_updated_date,
			last_updated_by
		)
		VALUES (
			#{inviteUserId},
			#{inviteTotalCounter},
			#{invitePayCounter},
			#{level1UserCounter},
			#{level2UserCounter},
			'Y',
			'N',
			NOW(),
			#{createdBy},
			NOW(),
			#{lastUpdatedBy}
		)ON DUPLICATE KEY UPDATE 
			invite_total_counter = invite_total_counter + #{inviteTotalCounter},
			invite_pay_counter = invite_pay_counter + #{invitePayCounter},
			level1_user_counter = level1_user_counter + #{level1UserCounter},
			level2_user_counter = level2_user_counter + #{level2UserCounter},
			last_updated_date = NOW(),
			last_updated_by = #{lastUpdatedBy}
	</insert>

</mapper>  